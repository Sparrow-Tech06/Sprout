<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<title>Sprout â€“ Simple Money Story Learning</title>
<meta name="google" content="notranslate">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<style>
:root{
  --bg:#ffffff;
  --text:#1a1a1a;
  --card:#ffffff;
  --primary:#4f46e5;
  --radius:16px;
  --border:1px solid rgba(0,0,0,0.08);
  --shadow:0 8px 20px rgba(0,0,0,0.06);
  --skeleton:#e5e7eb;
}

@media(prefers-color-scheme:dark){
:root{
  --bg:#121212;
  --text:#f8fafc;
  --card:#1e293b;
  --border:1px solid rgba(255,255,255,0.1);
  --skeleton:#334155;
}}

body{background:var(--bg);font-family:'Inter',system-ui,sans-serif;color:var(--text);transition: background 0.3s ease;} 

/* skeleton global */
.skeleton{
  background: linear-gradient(90deg, var(--skeleton) 25%, #f3f4f6 50%, var(--skeleton) 75%);
  background-size: 200% 100%;
  animation: skeleton 1.5s infinite linear;
}

@keyframes skeleton{0%{background-position:200% 0}100%{background-position:-200% 0}}

/* HEADER */
.header{background:var(--card);border-bottom:var(--border);position:sticky;top:0;z-index:1000;transition: transform .3s ease-in-out;}
.navbar-hidden{transform:translateY(-100%);} 

.logo{font-weight:700;font-size:1.1rem;letter-spacing: -0.5px;}
.tagline{font-size:.75rem;color:#64748b;}

.notification{background:rgba(79, 70, 229, 0.1);padding:8px;border-radius:50%;color:var(--primary);display:flex;align-items:center;justify-content:center;}

/* SIDEBAR */
.offcanvas{width:280px!important;border-right:var(--border);}
.offcanvas-body a{color:var(--text);text-decoration:none;padding:12px;display:flex;gap:12px;align-items:center;border-radius:10px;margin-bottom:4px;transition:0.2s;}
.offcanvas-body a:hover{background:rgba(79, 70, 229, 0.1);color:var(--primary);} 

/* CARD */
.story-card{border-radius:var(--radius);border:var(--border);background:var(--card);overflow:hidden;transition:.25s cubic-bezier(0.4, 0, 0.2, 1);height: 100%;}
.story-card:active{transform:scale(0.98);} 

.thumb{position:relative; overflow:hidden;}
.thumb img{width:100%;aspect-ratio:16/9;object-fit:cover;opacity:0;transition:opacity .4s ease-in;} 
.thumb img.loaded{opacity:1;} 

.img-skeleton{position:absolute;inset:0;z-index:1;}
.img-skeleton.hide{display:none;} 

.ribbon{position:absolute;right:10px;top:10px;background:var(--primary);color:#fff;padding:4px 10px;border-radius:30px;font-size:.65rem;font-weight:600;z-index:2;} 
.new{position:absolute;left:10px;top:10px;background:#ef4444;color:#fff;padding:4px 10px;border-radius:6px;font-size:.65rem;font-weight:600;z-index:2;} 

/* Modern Card Colors - Light Mode only */
@media (prefers-color-scheme: light) {
  #story-container:not(.loading)>.col-12:nth-child(5n+1) .story-card{background:#fdf2f8;}
  #story-container:not(.loading)>.col-12:nth-child(5n+2) .story-card{background:#f0f9ff;}
  #story-container:not(.loading)>.col-12:nth-child(5n+3) .story-card{background:#f0fdf4;}
  #story-container:not(.loading)>.col-12:nth-child(5n+4) .story-card{background:#fffbeb;}
  #story-container:not(.loading)>.col-12:nth-child(5n+5) .story-card{background:#f5f3ff;}
}

/* ERROR STATE */
.error-wrapper{min-height:60vh;display:flex;justify-content:center;align-items:center;text-align:center;}
.error-state img{max-width:180px;margin-bottom:20px;}

.search-btn{border:var(--border);border-radius:12px;background:var(--card);padding: 0 12px; color:var(--text);} 

</style>
</head>
<body>

<header id="main-header" class="header py-2">
  <div class="container-fluid d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center gap-1">
      <button class="btn border-0" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-label="Menu">
        <i class="bi bi-grid-fill fs-4"></i>
      </button>
      <div>
        <div class="logo">Sprout</div>
        <div class="tagline">Learn money, simply</div>
      </div>
    </div>
    <div class="d-flex gap-2 align-items-center">
      <a href="search.html" class="search-btn py-2" aria-label="Search"><i class="bi bi-search"></i></a>
      <a href="notifications.html" class="notification" aria-label="Notifications"><i class="bi bi-bell-fill"></i></a>
    </div>
  </div>
</header>

<aside class="offcanvas offcanvas-start" id="sidebar" tabindex="-1">
  <div class="offcanvas-header border-bottom">
    <h5 class="fw-bold mb-0">Sprout Menu</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <nav class="offcanvas-body">
    <a href="#"><i class="bi bi-person-circle"></i> My Profile</a>
    <a href="collection/save.html"><i class="bi bi-bookmark-heart"></i> Saved Stories</a>
    <a href="#"><i class="bi bi-lightbulb"></i> Suggest a Topic</a>
    <hr>
    <a href="#"><i class="bi bi-shield-check"></i> Privacy Policy</a>
    <a href="#"><i class="bi bi-info-circle"></i> Help & FAQ</a>
  </nav>
</aside>

<main class="container py-3">
  <section id="story-container" class="row g-4"></section>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
const box = document.getElementById("story-container");

// Enhanced Skeleton Loader
function showSkeletons(n = 4) {
  box.classList.add("loading");
  let h = "";
  for (let i = 0; i < n; i++) {
    h += `<div class="col-12">
      <div class="story-card p-0 shadow-sm">
        <div class="skeleton" style="height:180px; border-radius:16px 16px 0 0"></div>
        <div class="p-3">
          <div class="skeleton mb-2" style="height:16px; width:80%"></div>
          <div class="skeleton mb-3" style="height:12px; width:60%"></div>
          <div class="skeleton" style="height:10px; width:30%"></div>
        </div>
      </div>
    </div>`;
  }
  box.innerHTML = h;
}

showSkeletons();

// Fetch Stories
fetch("stories.json")
  .then(r => {
    if (!r.ok) throw new Error('Network response was not ok');
    return r.json();
  })
  .then(data => {
    render(data);
    box.classList.remove("loading");
  })
  .catch(err => {
    console.error("Fetch error:", err);
    box.innerHTML = `
      <div class="error-wrapper w-100">
        <div class="error-state p-4">
          <img src="https://cdn-icons-png.flaticon.com/512/7486/7486740.png" alt="Error Illustration">
          <h4 class="fw-bold">Oops! Stories missing</h4>
          <p class="text-muted">We couldn't load the stories. Check your data connection.</p>
          <button class="btn btn-primary rounded-pill px-4 mt-2" onclick="location.reload()">Try Again</button>
        </div>
      </div>`;
  });

function render(data) {
  if (!data.length) {
    box.innerHTML = "<p class="text-center">No stories found.</p>";
    return;
  }
  
  let h = "";
  data.forEach(s => {
    h += `<div class="col-12">
      <a href="${s.link}" class="text-decoration-none text-dark">
        <article class="story-card shadow-sm">
          <div class="thumb">
            <div class="img-skeleton skeleton"></div>
            <img src="${s.image}" alt="${s.title}" loading="lazy"
              onload="this.classList.add('loaded'); this.previousElementSibling.classList.add('hide');"
              onerror="this.src='https://placehold.co/600x400?text=Story+Image'; this.classList.add('loaded'); this.previousElementSibling.classList.add('hide');">
            ${s.isNew ? `<div class='new'>NEW</div>` : ""}
            <div class="ribbon">${s.tag}</div>
          </div>
          <div class="p-3">
            <h6 class="fw-bold mb-1" style="color:var(--text)">${s.title}</h6>
            <p class="small text-secondary mb-2">${s.subtitle}</p>
            <div class="d-flex align-items-center gap-2">
               <small class="text-muted"><i class="bi bi-stopwatch"></i> ${s.duration}</small>
            </div>
          </div>
        </article>
      </a>
    </div>`;
  });
  box.innerHTML = h;
}

// Smart Header Hide/Show
let lastScroll = 0;
const header = document.getElementById("main-header");

window.addEventListener("scroll", () => {
  const currentScroll = window.pageYOffset;
  if (currentScroll <= 0) {
    header.classList.remove("navbar-hidden");
    return;
  }
  if (currentScroll > lastScroll && !header.classList.contains("navbar-hidden") && currentScroll > 80) {
    header.classList.add("navbar-hidden");
  } else if (currentScroll < lastScroll && header.classList.contains("navbar-hidden")) {
    header.classList.remove("navbar-hidden");
  }
  lastScroll = currentScroll;
});
</script>

</body>
</html>
